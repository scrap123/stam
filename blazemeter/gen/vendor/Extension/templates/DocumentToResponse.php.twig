<?php



     /**
     * Export to response format
     *
     * @return array An array representing response
     */
    public function toResponse()
    {
        return $this->getFields();
    }

     /**
     * Export selected fields from document to an array.
     *
     * @param array $fields list of fields to export
     * @return array An array with the document data.
     */
    public function getFields(array $fields=array())
    {
        if (empty($fields)) {
            $fields = array_merge(['id'],array_keys($this->getMetadata()['fields']));
        }
        $array = [];
        foreach ($fields as $field) {
            {#if($field == 'id'){#}
                {#$array['id'] = $this->getId();#}

                {#continue;#}
            {#}#}
            $methodName='get'.ucfirst($field);
            if(method_exists($this,$methodName)){
                $array[$field] = $this->$methodName($field);
                if (method_exists($array[$field], 'getFields')) {
                    $array[$field] = $array[$field]->getFields();
                }elseif($array[$field] instanceof \MongoId){
                    $array[$field] = strval($array[$field]);
                }
            }else{
                $array[$field] = null;
            }
        }
        return $array;
    }

